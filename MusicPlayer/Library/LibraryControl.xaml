<UserControl x:Class="MusicPlayer.Library.LibraryControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MusicPlayer.Library"
             xmlns:core="clr-namespace:MusicPlayer"
             xmlns:commands="clr-namespace:MusicPlayer.Commands"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="500"
             d:DataContext="{d:DesignInstance Type=local:MockLibraryViewModel, IsDesignTimeCreatable=True}">
  <UserControl.Resources>
    <Style x:Key="LibraryStyle" 
           TargetType="{x:Type TreeViewItem}" BasedOn="{StaticResource {x:Type TreeViewItem}}">
      <EventSetter Event="MouseDoubleClick" Handler="OnItemMouseDoubleClick" />
      <Setter Property="VerticalContentAlignment" Value="Stretch"/>
      <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
      <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
      <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />
      <Setter Property="FontWeight" Value="Normal" />
      <Setter Property="TextBlock.Foreground" Value="WhiteSmoke"/>
      <Style.Triggers>
        <Trigger Property="IsSelected" Value="True">
          <Setter Property="commands:TreeViewItemBehavior.BringIntoViewWhenSelected" Value="True" />
          <Setter Property="FontWeight" Value="Bold" />
        </Trigger>
        <DataTrigger Binding="{Binding IsDim}" Value="True">
          <Setter Property="TextBlock.Foreground" Value="DimGray"/>
        </DataTrigger>
      </Style.Triggers>
    </Style>

    <core:EnumBoolConverter x:Key="EnumBooleanConverter"/>

    <ContextMenu x:Key="ArtistCM">
      <MenuItem Header="Add Artist To Playlist" Click="Add_Shallow"/>
      <MenuItem Header="Add Artist To Playlist (Deep)" Click="Add_Deep"/>
      <MenuItem Header="Play Artist" Click="Play_Shallow"/>
      <MenuItem Header="Play Artist (Deep)" Click="Play_Deep"/>
      <MenuItem Header="Edit Artist Information" Click="Edit"/>
    </ContextMenu>

    <ContextMenu x:Key="AlbumCM">
      <MenuItem Header="Add Album To Playlist" Click="Add_Shallow"/>
      <MenuItem Header="Add Album To Playlist (Deep)" Click="Add_Deep"/>
      <MenuItem Header="Play Album" Click="Play_Shallow"/>
      <MenuItem Header="Play Album (Deep)" Click="Play_Deep"/>
      <MenuItem Header="Edit Album Information" Click="Edit"/>
      <MenuItem Header="Update Album Art" Click="EditArt"/>
    </ContextMenu>

    <ContextMenu x:Key="SongCM">
      <MenuItem Header="Add Song To Playlist" Click="Add_Shallow"/>
      <MenuItem Header="Add Song To Playlist (Deep)" Click="Add_Deep"/>
      <MenuItem Header="Play Song" Click="Play_Shallow"/>
      <MenuItem Header="Play Song (Deep)" Click="Play_Deep"/>
      <MenuItem Header="Edit Song Information" Click="Edit"/>
    </ContextMenu>

    <ContextMenu x:Key="RecordingCM">
      <MenuItem Header="Add Recording To Playlist" Click="Add_Shallow"/>
      <MenuItem Header="Play Recording" Click="Play_Shallow"/>
      <MenuItem Header="Edit Recording Information" Click="Edit"/>
    </ContextMenu>

    <HierarchicalDataTemplate DataType="{x:Type local:ArtistViewModel}"
                              ItemsSource="{Binding Children}">
      <StackPanel Orientation="Horizontal" Background="Transparent"
                  ContextMenu="{StaticResource ArtistCM}">
        <core:WeightBar Margin="0,0,5,0"/>
        <TextBlock Text="{Binding Name}" FontSize="14" VerticalAlignment="Center"/>
      </StackPanel>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type local:AlbumViewModel}"
                              ItemsSource="{Binding Children}">
      <StackPanel Orientation="Horizontal" Background="Transparent"
                  ContextMenu="{StaticResource AlbumCM}">
        <core:WeightBar Margin="0,0,5,0"/>
        <Image Width="32" Height="32" Margin="0,0,5,0" Source="{Binding AlbumArt}"/>
        <TextBlock Text="{Binding Name}" FontSize="14" VerticalAlignment="Center"/>
      </StackPanel>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type local:SongViewModel}"
                              ItemsSource="{Binding Children}">
      <StackPanel Orientation="Horizontal" Background="Transparent"
                  ContextMenu="{StaticResource SongCM}">
        <core:WeightBar Margin="0,0,5,0"/>
        <TextBlock Text="{Binding Name}" FontSize="14" VerticalAlignment="Center"/>
      </StackPanel>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type local:RecordingViewModel}">
      <StackPanel Orientation="Horizontal" Background="Transparent"
                  ContextMenu="{StaticResource RecordingCM}">
        <core:WeightBar Margin="0,0,5,0"/>
        <TextBlock Text="{Binding Name}" FontSize="14" VerticalAlignment="Center"/>
        <TextBlock Text="{Binding LiveString}" FontSize="14" VerticalAlignment="Center" Margin="5,0,0,0"/>
      </StackPanel>
    </HierarchicalDataTemplate>
  </UserControl.Resources>
  <DockPanel Background="{StaticResource DarkInsetPanel}">
    <DockPanel DockPanel.Dock="Top"  Margin="10,2,10,2">
      <DockPanel DockPanel.Dock="Top">
        <TextBlock DockPanel.Dock="Left"
                   VerticalAlignment="Center"
                   Text="Search:"
                   TextBlock.FontSize="14" TextAlignment="Left"
                   Margin="0,0,10,0"/>
        <TextBox Name="shuffleToggleButton"
                 TextBlock.FontSize="12" TextBlock.TextAlignment="Left"
                 KeyDown="SearchTextBox_KeyDown" 
                 Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                 VerticalContentAlignment="Center"
                 Margin="1,2,4,2" Height="24" />
      </DockPanel>
      <Grid DockPanel.Dock="Bottom" Margin="55,0,0,0">
        <Grid.ColumnDefinitions>
          <ColumnDefinition/>
          <ColumnDefinition/>
          <ColumnDefinition/>
          <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <RadioButton Content="All" GroupName="SearchSelection" Grid.Column="0"
                     IsChecked="{Binding Path=SearchChoice,
                                  Converter={StaticResource EnumBooleanConverter},
                                  ConverterParameter={x:Static local:SearchChoices.All}}"/>
        <RadioButton x:Name="radioSearchArtist"
                     Content="Artist" GroupName="SearchSelection" Grid.Column="1"
                     IsChecked="{Binding Path=SearchChoice, 
                                  Converter={StaticResource EnumBooleanConverter}, 
                                  ConverterParameter={x:Static local:SearchChoices.Artist}}"/>
        <RadioButton x:Name="radioSearchAlbum"
                     Content="Album" GroupName="SearchSelection" Grid.Column="2"
                     IsChecked="{Binding Path=SearchChoice, 
                                  Converter={StaticResource EnumBooleanConverter}, 
                                  ConverterParameter={x:Static local:SearchChoices.Album}}"/>
        <RadioButton Content="Song" GroupName="SearchSelection" Grid.Column="3" 
                     IsChecked="{Binding Path=SearchChoice, 
                                  Converter={StaticResource EnumBooleanConverter}, 
                                  ConverterParameter={x:Static local:SearchChoices.Song}}"/>
      </Grid>
    </DockPanel>
    <TabControl SelectionChanged="LibraryView_SelectionChanged">
      <TabItem Header="Classic" FontSize="14">
        <TreeView ItemsSource="{Binding ClassicArtistViewModels}"
                  TreeViewItem.Expanded="TreeViewItem_Expanded"
                  ItemContainerStyle="{StaticResource LibraryStyle}"
                  KeyDown="Tree_KeyDown">
        </TreeView>
      </TabItem>
      <TabItem Header="Simple"  FontSize="14">
        <TreeView ItemsSource="{Binding SimpleViewModels}" 
                  TreeViewItem.Expanded="TreeViewItem_Expanded"
                  ItemContainerStyle="{StaticResource LibraryStyle}"
                  KeyDown="Tree_KeyDown"/>
      </TabItem>
      <TabItem Header="Album"  FontSize="14">
        <TreeView ItemsSource="{Binding AlbumViewModels}" 
                  TreeViewItem.Expanded="TreeViewItem_Expanded"
                  ItemContainerStyle="{StaticResource LibraryStyle}"
                  KeyDown="Tree_KeyDown"/>
      </TabItem>
    </TabControl>
  </DockPanel>
</UserControl>
